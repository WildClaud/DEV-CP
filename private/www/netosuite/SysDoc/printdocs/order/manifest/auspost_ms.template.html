<font style="font-size:16px; font-weight:bold; margin: 12px;">Print Contract Mailing Statement</font>
<br><br>
<!--##[?
my $ctl_vars = 0;
%DESTINATION = (
		'N1'=> {
			'name'=>'N1 _Sydney',
			'displayorder'=>$ctl_vars++,
		},
		'N2'=> {
			'name'=>'N2 _NSW Country',
			'displayorder'=>$ctl_vars++,
		},
		'V1'=> {
			'name'=>'V1 _Melbourne',
			'displayorder'=>$ctl_vars++,
		},
		'V2'=> {
			'name'=>'V2 _Victorian Country',
			'displayorder'=>$ctl_vars++,
		},
		'Q1'=> {
			'name'=>'Q1 _Brisbane',
			'displayorder'=>$ctl_vars++,
		},
		'Q2'=> {
			'name'=>'Q2 _QLD Country -South',
			'displayorder'=>$ctl_vars++,
		},
		'Q3'=> {
			'name'=>'Q3 _QLD Country North',
			'displayorder'=>$ctl_vars++,
		},
		'S1'=> {
			'name'=>'S1 _Adelaide',
			'displayorder'=>$ctl_vars++,
		},
		'S2'=> {
			'name'=>'S2 _SA Country',
			'displayorder'=>$ctl_vars++,
		},
		'W1'=> {
			'name'=>'W1 _Perth',
			'displayorder'=>$ctl_vars++,
		},
		'W2'=> {
			'name'=>'W2 _WA Country Near',
			'displayorder'=>$ctl_vars++,
		},
		'W3'=> {
			'name'=>'W3 _WA Country Far',
			'displayorder'=>$ctl_vars++,
		},
		
		'W4'=> {
			'name'=>'W4 _WA External Territories',
			'displayorder'=>$ctl_vars++,
		},
		'T1'=> {
			'name'=>'T1 _Tasmania',
			'displayorder'=>$ctl_vars++,
		},
		'NT1'=> {
			'name'=>'NT1 _Northern Territory Near',
			'displayorder'=>$ctl_vars++,
		},
		'NT2'=> {
			'name'=>'NT2 _Northern Territory Remote',
			'displayorder'=>$ctl_vars++,
		},
		'NF'=> {
			'name'=>'NF _Norfolk Island',	
			'displayorder'=>$ctl_vars++,
		},
		'AAT'=> {
			'name'=>'AAT _Aust. Antarctic Territories',		
			'displayorder'=>$ctl_vars++,
		},
		'LC'=> {
			'name'=>'LC _Local Area',	
			'displayorder'=>$ctl_vars++,
		},
);
%mparam = extract_KV_data($_DATA{module_param}); 
####parcels under 500g 
%UNWR = ();
####parcels over 500g regular service
%OVWER = ();
####parcels over 500g express service 
%OVWERE = ();
####parcels over 500g express platinum service 
%OVWEREP = ();
####parcels over 500g express medical service 
%OVWERM = ();
### small letters
%SLETTERS =();
#####large letters domestice
%DLETTERS = ();
#####large letters External
%ELETTERS = ();
######other services
%OSERVS = ();
my $db_mid = db_quote($_DATA{manifest_id});
my $sql = "SELECT C.*,".
		"S.shserv_code, S.shserv_name ".
		"FROM SH_CONSIGNMENTS C INNER JOIN SH_SERVICES S USING (shserv_id) ".
		"WHERE manifest_id=$db_mid ORDER BY cngmt_id";
my $sth = run_sql_dyn($sql);

while($cng = $sth->fetchrow_hashref) {
	my $serv_code = uc($cng->{shserv_code});
	my $serv_name = uc($cng->{shserv_name});
	my $db_cid = db_quote($cng->{cngmt_id});
	my $sql2 = "SELECT * FROM SH_ARTICLES WHERE cngmt_id=$db_cid ORDER BY art_id";
	my $sth2 = run_sql_dyn($sql2);
	my($cubic, $weight,$count);
	my $zone_sql = "SELECT zone_name FROM ZONES_INFO WHERE zone_id =?";
	my $zone = get_one($zone_sql,$cng->{zone_id});
	while($row = $sth2->fetchrow_hashref) {
		$count++;

		if($row->{shipping} <=0) { $row->{shipping}=0.01; }

		$cubic += $row->{cubic};
		$weight += $row->{shipping};
		my $actual_weight = sprintf("%.02f",$row->{shipping});
		my $cubic_weight =  sprintf("%.02f",$row->{cubic}*$cng->{cubic_modifier});
		if($cubic_weight > $row->{shipping}){
			$actual_weight = $cubic_weight ;
		}
		if($actual_weight <= 0.25) {
			if($cng->{shserv_code} eq 'R') {
				#$mparam{LocalCountryZone} $mparam{ExternalTerritoryZone}
				if($mparam{LocalCountryZone} eq $zone) {
					#regular local area service
					$UNWR{'lru'}{quantity}++;
				}elsif($mparam{ExternalTerritoryZone} eq $zone) {
					#regular external territory service
					$UNWR{'eru'}{quantity}++;
				}else {
					##regular rest of austrlia service
					$UNWR{'rru'}{quantity}++;
				}
			}elsif($cng->{shserv_code} eq 'E') {
				$UNWR{'expr'}{quantity}++;
			}elsif($cng->{shserv_code} eq 'EP') {
				$UNWR{'exprep'}{quantity}++;
			}elsif($cng->{shserv_code} eq 'M') {
				#medical/education/remote service
				$UNWR{'mer'}{quantity}++;
			}elsif($cng->{shserv_code} eq 'L'){
				if($row->{'length'}<= 0.02||$row->{'width'}<=0.02 ||$row->{'height'}<=0.02){
	        if($actual_weight < 0.125) {
	        	if($mparam{ExternalTerritoryZone} eq $zone) {
							$SLETTERS{'external'}++;
						}else{
							$SLETTERS{'domestic'}++;
						}	
					}elsif($actual_weight ==0.125) {
						if($mparam{ExternalTerritoryZone} eq $zone) {
							$ELETTERS{'L'}{quantity}++;
						}else{
							$DLETTERS{'L'}{quantity}++;
						}	
					}elsif($actual_weight>0.125 && $actual_weight<=0.25){
						if($mparam{ExternalTerritoryZone} eq $zone) {
							$ELETTERS{'M'}{quantity}++;
						}else{
							$DLETTERS{'M'}{quantity}++;
						}
					}
				}
			}
		}elsif($actual_weight > 0.25 && $actual_weight <= 0.5) {
			if($cng->{shserv_code} eq 'R') {
				if($mparam{LocalCountryZone} eq $zone) {
					$UNWR{'lou'}{quantity}++;
				}elsif($mparam{ExternalTerritoryZone} eq $zone) {
					$UNWR{'eou'}{quantity}++;
				}else {
					$UNWR{'rou'}{quantity}++;
				}
			}elsif($cng->{shserv_code} eq 'E') {
				$UNWR{'expe'}{quantity}++;
			}elsif($cng->{shserv_code} eq 'EP') {
				$UNWR{'expeep'}{quantity}++;
			}elsif($cng->{shserv_code} eq 'M') {
				#medical/education/remote service 
				$UNWR{'mor'}{quantity}++;
			}elsif($cng->{shserv_code} eq 'L'){
				if($row->{'length'}<= 0.02 || $row->{'width'}<=0.02 || $row->{'height'}<=0.02){
					if($mparam{ExternalTerritoryZone} eq $zone) {
						$ELETTERS{'H'}{quantity}++;
					}else{
						$DLETTERS{'H'}{quantity}++;
					}
				}				
			}
		}elsif($actual_weight>0.5){
			if($cng->{shserv_code} eq 'R') {
				$OVWER{$zone}{quantity}++;
				$OVWER{$zone}{weight} += $actual_weight;
			}elsif($cng->{shserv_code} eq 'E') {
				$OVWERE{$zone}{quantity}++;
				$OVWERE{$zone}{actual_weight} += $actual_weight;
				$OVWERE{$zone}{cubic_weight} += $cubic_weight;
			}elsif($cng->{shserv_code} eq 'EP') {
				$OVWEREP{$zone}{quantity}++;
				$OVWEREP{$zone}{actual_weight} += $actual_weight;
				$OVWEREP{$zone}{cubic_weight} += $cubic_weight;
			}elsif($cng->{shserv_code} eq 'M') {
				$OVWERM{$zone}{quantity}++;
				$OVWERM{$zone}{actual_weight} += $actual_weight;
				$OVWERM{$zone}{cubic_weight} += $cubic_weight;
			}
		}
	}
	if($cng->{signature} eq 'y') {
		if($mparam{ExternalTerritoryZone} eq $zone) {
			$OSERVS{'external'}++;
		}else{
			$OSERVS{'domestic'}++;
		}
	}
}
?]##-->
<table width="100%" border="0" cellpadding="0" cellspacing="0" >
<tr><td><table width="100%" border="0" cellpadding="2" cellspacing="0" >
<tr>
  <td ><font style="font-size:15px; font-weight:bold;"> Customer Details</font></td>
</tr>
<tr><td>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
					<tr><td width="1%" nowrap><b>Manifest Created Date</b></td>
	<td><!--##[? print format_date({date=> $_DATA{date_manifest}, format=>'#W, #d #k, #Y'}) ?]##--></td></tr>
	<tr><td  nowrap><b>Name</b></td>
		<td><!--##[? print $mparam{ReturnName} ?]##--></td></tr>
	<tr><td nowrap><b>Address</b></td>
		<td><!--##[? print $mparam{ReturnAddressLine1} ?]##--></td></tr>
		<tr><td nowrap>&nbsp;</td><td nowrap><!--##[? print $mparam{ReturnAddressLine2} ?]##--></td></tr>
			<tr><td nowrap><b>Post Code</b></td>
		<td><!--##[? print $mparam{ReturnPostcode}  ?]##--></td></tr>
			<tr><td nowrap><b>Suburb</b></td>
		<td><!--##[? print $mparam{ReturnSuburb}  ?]##--></td></tr>
			<tr><td nowrap><b>State</b></td>
		<td><!--##[? print $mparam{ReturnStateCode}  ?]##--></td></tr>
		<tr><td nowrap><b>Country</b></td>
		<td><!--##[? print country_name($mparam{ReturnCountryCode}) ?]##--></td></tr>
		<tr><td nowrap><b>Phone</b></td>
		<td><!--##[? print $mparam{ReturnPhone}  ?]##--></td></tr>
		<tr><td nowrap><b>Charge Account No</b></td>
		<td><!--##[? print $_DATA{merchant_acc} ?]##--></td></tr>
		<tr><td nowrap><b>Customer Reference</b></td>
		<td><!--##[? print $mparam{CustomerReference} ?]##--></td></tr>
		
</table>
</td>
	</tr></table></td>
</tr></table>
<br>
<table width="100%" border="0" cellpadding="0" cellspacing="0" >
<tr><td><table width="100%" border="0" cellpadding="2" cellspacing="0" >
<tr>
  <td ><font style="font-size:15px; font-weight:bold;">Parcels Under 500g within Australia - B30</font></td>
</tr>
<tr><td>
<table width="100%" cellpadding="2" cellspacing="0" border="0" class="inpbox" >
		<tr class="hdr"> 
		<td width="200px" nowrap><b>B30</b></td>
		<td width="150px" nowrap>Up to 250gms</td>
		<td width="150px" nowrap>Over 250g to 500g</td>
	 </tr>
<!--##[?
$UNWR{'lru'}{quantity} = $UNWR{'lru'}{quantity}?$UNWR{'lru'}{quantity}:'&nbsp;';
$UNWR{'lou'}{quantity} = $UNWR{'lou'}{quantity}?$UNWR{'lou'}{quantity}:'&nbsp;';
$UNWR{'eru'}{quantity} = $UNWR{'eru'}{quantity}?$UNWR{'eru'}{quantity}:'&nbsp;';
$UNWR{'eou'}{quantity} = $UNWR{'eou'}{quantity}?$UNWR{'eou'}{quantity}:'&nbsp;';
$UNWR{'rru'}{quantity} = $UNWR{'rru'}{quantity}?$UNWR{'rru'}{quantity}:'&nbsp;';
$UNWR{'rou'}{quantity} = $UNWR{'rou'}{quantity}?$UNWR{'rou'}{quantity}:'&nbsp;';
$UNWR{'expr'}{quantity} = $UNWR{'expr'}{quantity}?$UNWR{'expr'}{quantity}:'&nbsp;';
$UNWR{'expe'}{quantity} = $UNWR{'expe'}{quantity}?$UNWR{'expe'}{quantity}:'&nbsp;';
$UNWR{'exprep'}{quantity} = $UNWR{'exprep'}{quantity}?$UNWR{'exprep'}{quantity}:'&nbsp;';
$UNWR{'expeep'}{quantity} = $UNWR{'expeep'}{quantity}?$UNWR{'expeep'}{quantity}:'&nbsp;';
$UNWR{'mer'}{quantity} = $UNWR{'mer'}{quantity}?$UNWR{'mer'}{quantity}:'&nbsp;';
$UNWR{'mor'}{quantity} = $UNWR{'mor'}{quantity}?$UNWR{'mor'}{quantity}:'&nbsp;';
?]##-->
		<tr class="row0">
			<td nowrap>LC:Local Area</td>
			<td nowrap><!--##[? print $UNWR{'lru'}{quantity} ?]##--></td>
			<td nowrap><!--##[? print $UNWR{'lou'}{quantity} ?]##--></td>
		</tr>
		<tr class="row0">
			<td nowrap>RA:Rest Of Australia</td>
			<td nowrap><!--##[? print $UNWR{'rru'}{quantity} ?]##--></td>
			<td nowrap><!--##[? print $UNWR{'rou'}{quantity}?]##--></td>
		</tr>
	<tr class="row0">
			<td nowrap>XT:External Territory</td>
			<td nowrap><!--##[? print $UNWR{'eru'}{quantity} ?]##--></td>
			<td nowrap><!--##[? print $UNWR{'eou'}{quantity} ?]##--></td>
		</tr>
	<tr class="row0">
			<td nowrap >Express Post&nbsp;&nbsp;(<b>B20</b>)&nbsp;</td>
			
			<td nowrap><!--##[? print $UNWR{'expr'}{quantity} ?]##--></td>
			<td nowrap><!--##[? print $UNWR{'expe'}{quantity} ?]##--></td>
		</tr>
	<tr class="row0">
			<td nowrap >Express Post Platinum&nbsp;&nbsp;(<b>B70</b>)&nbsp;</td>
			<td nowrap><!--##[? print $UNWR{'exprep'}{quantity} ?]##--></td>
			<td nowrap><!--##[? print $UNWR{'expeep'}{quantity} ?]##--></td>
		</tr>
	<tr class="row0">
			<td nowrap >Medical/Education/Remotes&nbsp;&nbsp;(<b>B60</b>)&nbsp;</td>
			<td nowrap><!--##[? print $UNWR{'mer'}{quantity} ?]##--></td>
			<td nowrap><!--##[? print $UNWR{'mor'}{quantity} ?]##--></td>
		</tr>
</table>
</td>
	</tr></table></td>
</tr></table>
<br>
<table width="100%" border="0" cellpadding="0" cellspacing="0" >
<tr><td><table width="100%" border="0" cellpadding="2" cellspacing="0" >
<tr>
  <td ><font style="font-size:15px; font-weight:bold;">Parcels Over 500g within Australia-B31</font></td>
</tr>
<tr><td>
<table width="100%" cellpadding="2" cellspacing="0" border="0" class="inpbox" >
		<tr class="hdr"> 
		<td width="120px" nowrap rowspan="3">Destination</td>
		<td width="480px" align="center" nowrap colspan="6">Regular - B31</td>
	 </tr>
	 <tr class="hdr"> 
		<td width="160px" nowrap  colspan="2" >
			Actual Declared
		</td>
		<td width="160px" nowrap colspan="2" >&nbsp;
			
		</td>
		<td width="160px" nowrap colspan="2" >
			Total Found
		</td>
	 </tr>
	 <tr class="hdr"> 
	 <td width="80px" nowrap>
	 	Quantity
	</td>
	<td width="80px" nowrap>
		Weight(kg)
	</td>
	<td width="80px" nowrap>&nbsp;
		
	</td>
	<td width="80px" nowrap>&nbsp;
		
	</td>
	<td width="80px" nowrap>
		Quantity
	</td>
	<td width="80px" nowrap>
		Weight(kg)
	</td>
	</tr>
	<!--##[?
	my $total_qty_r = $total_weight_r=0;
	for my $k (sort {$DESTINATION{$a}{displayorder} <=> $DESTINATION{$b}{displayorder}} keys %DESTINATION) {
		$OVWER{$k}{quantity} = $OVWER{$k}{quantity}? $OVWER{$k}{quantity}:'&nbsp';
		$OVWER{$k}{weight} = $OVWER{$k}{weight}? $OVWER{$k}{weight}:'&nbsp;';
		print qq~##-->
		<tr class="row0">
			<td nowrap>$DESTINATION{$k}{name}</td>
			<td nowrap>$OVWER{$k}{quantity}</td>
			<td nowrap>$OVWER{$k}{weight} </td>
			<td nowrap>&nbsp; </td>
			<td nowrap>&nbsp;</td>
			<td nowrap>&nbsp;</td>
			<td nowrap>&nbsp;</td>
		</tr>
		<!--##~;
		$total_qty_r += $OVWER{$k}{quantity};
		$total_weight_r +=  $OVWER{$k}{weight};
</tr>
	}
	print qq~##-->
		<tr class="row0">
	<td nowrap align= "right">Total</td>
	<td nowrap>&nbsp;</td>
			<td nowrap>&nbsp;</td>
			<td nowrap>&nbsp;</td>
			<td nowrap>&nbsp;</td>
			<td nowrap>$total_qty_r</td>
			<td nowrap>$total_weight_r</td>
		</tr>
				<!--##~;
?]##-->
</table>
</td>
	</tr></table></td>
</tr></table>
<br>
<table width="100%" border="0" cellpadding="0" cellspacing="0" >
<tr><td><table width="100%" border="0" cellpadding="2" cellspacing="0" >
<tr>
  <td ><font style="font-size:15px; font-weight:bold;">Parcels Over 500g within Australia - B21</font></td>
</tr>
<tr><td>
<table width="100%" cellpadding="2" cellspacing="0" border="0" class="inpbox" >
		<tr class="hdr"> 
		<td width="120px" nowrap rowspan="3">Destination</td>
		<td width="480px" align="center" nowrap colspan="6">Regular - B21</td>
	 </tr>
	 <tr class="hdr"> 
		<td width="160px" nowrap  colspan="2" >
			Actual Weight Parcels
		</td>
		<td width="160px" nowrap colspan="2" >
			Cubic Weight Parcels
		</td>
		<td width="160px" nowrap colspan="2" >
			Total All Parcels
		</td>
	 </tr>
	 <tr class="hdr"> 
	 <td width="80px" nowrap>
	 	Quantity
	</td>
	<td width="80px" nowrap>
		Weight(kg)
	</td>
	<td width="80px" nowrap>
		Quantity
	</td>
	<td width="80px" nowrap>
		Weight(kg)
	</td>
	<td width="80px" nowrap>
		Quantity
	</td>
	<td width="80px" nowrap>
		Weight(kg)
	</td>
	</tr>
<!--##[?
	my $total_qty_ex = $total_weight_ex=0;
	for my $k (sort {$DESTINATION{$a}{displayorder} <=> $DESTINATION{$b}{displayorder}} keys %DESTINATION) {
		$OVWERE{$k}{quantity} = $OVWERE{$k}{quantity}? $OVWERE{$k}{quantity}:'&nbsp';
		$OVWERE{$k}{actual_weight} = $OVWERE{$k}{actual_weight}? $OVWERE{$k}{actual_weight}:'&nbsp;';
		$OVWERE{$k}{cubic_weight} = $OVWERE{$k}{cubic_weight}? $OVWERE{$k}{cubic_weight}:'&nbsp;';
		if($OVWERE{$k}{quantity} > 0 && $OVWERE{$k}{cubic_weight} eq '&nbsp;') {
			$OVWERE{$k}{cubic_weight} = 0;
		}
		print qq~##-->
		<tr class="row0">
			<td nowrap>$DESTINATION{$k}{name}</td>
			<td nowrap>$OVWERE{$k}{quantity}</td>
			<td nowrap>$OVWERE{$k}{actual_weight} </td>
			<td nowrap>$OVWERE{$k}{quantity} </td>
			<td nowrap>$OVWERE{$k}{cubic_weight}</td>
			<td nowrap>&nbsp;</td>
			<td nowrap>&nbsp;</td>
		</tr>
		<!--##~;
		$total_qty_ex += $OVWERE{$k}{quantity};
		$total_weight_ex +=  $OVWERE{$k}{actual_weight};
</tr>
	}
	print qq~##-->
		<tr class="row0">
	<td nowrap align= "right">Total</td>
	<td nowrap>&nbsp;</td>
			<td nowrap>&nbsp;</td>
			<td nowrap>&nbsp;</td>
			<td nowrap>&nbsp;</td>
			<td nowrap>$total_qty_ex</td>
			<td nowrap>$total_weight_ex</td>
		</tr>
				<!--##~;
?]##-->
</table>
</td>
	</tr></table></td>
</tr></table>
<br>
<table width="100%" border="0" cellpadding="0" cellspacing="0" >
<tr><td><table width="100%" border="0" cellpadding="2" cellspacing="0" >
<tr>
  <td ><font style="font-size:15px; font-weight:bold;">Parcels Over 500g within Australia - B71</font></td>
</tr>
<tr><td>
<table width="100%" cellpadding="2" cellspacing="0" border="0" class="inpbox" >
		<tr class="hdr"> 
		<td width="120px" nowrap rowspan="3">Destination</td>
		<td width="480px" align="center" nowrap colspan="6">Regular - B71</td>
	 </tr>
	 <tr class="hdr"> 
		<td width="160px" nowrap  colspan="2" >
			Actual Weight Parcels
		</td>
		<td width="160px" nowrap colspan="2" >
			Cubic Weight Parcels
		</td>
		<td width="160px" nowrap colspan="2" >
			Total All Parcels
		</td>
	 </tr>
	 <tr class="hdr"> 
	 <td width="80px" nowrap>
	 	Quantity
	</td>
	<td width="80px" nowrap>
		Weight(kg)
	</td>
	<td width="80px" nowrap>
		Quantity
	</td>
	<td width="80px" nowrap>
		Weight(kg)
	</td>
	<td width="80px" nowrap>
		Quantity
	</td>
	<td width="80px" nowrap>
		Weight(kg)
	</td>
	</tr>
<!--##[?
	my $total_qty_exp = $total_weight_exp=0;
	for my $k (sort {$DESTINATION{$a}{displayorder} <=> $DESTINATION{$b}{displayorder}} keys %DESTINATION) {
		$OVWEREP{$k}{quantity} = $OVWEREP{$k}{quantity}? $OVWEREP{$k}{quantity}:'&nbsp';
		$OVWEREP{$k}{actual_weight} = $OVWEREP{$k}{actual_weight}? $OVWEREP{$k}{actual_weight}:'&nbsp;';
		$OVWEREP{$k}{cubic_weight} = $OVWEREP{$k}{cubic_weight}? $OVWEREP{$k}{cubic_weight}:'&nbsp;';
		if($OVWEREP{$k}{quantity} > 0 && $OVWEREP{$k}{cubic_weight} eq '&nbsp;') {
			$OVWEREP{$k}{cubic_weight} = 0;
		}
		print qq~##-->
		<tr class="row0">
			<td nowrap>$DESTINATION{$k}{name}</td>
			<td nowrap>$OVWEREP{$k}{quantity}</td>
			<td nowrap>$OVWEREP{$k}{actual_weight} </td>
			<td nowrap>$OVWEREP{$k}{quantity} </td>
			<td nowrap>$OVWEREP{$k}{cubic_weight}</td>
			<td nowrap>&nbsp;</td>
			<td nowrap>&nbsp;</td>
		</tr>
		<!--##~;
		$total_qty_exp += $OVWEREP{$k}{quantity};
		$total_weight_exp +=  $OVWEREP{$k}{actual_weight};
</tr>
	}
	print qq~##-->
		<tr class="row0">
	<td nowrap align= "right">Total</td>
	<td nowrap>&nbsp;</td>
			<td nowrap>&nbsp;</td>
			<td nowrap>&nbsp;</td>
			<td nowrap>&nbsp;</td>
			<td nowrap>$total_qty_exp</td>
			<td nowrap>$total_weight_exp</td>
		</tr>
				<!--##~;
?]##-->
</table>
</td>
	</tr></table></td>
</tr></table>
<br>
<table width="100%" border="0" cellpadding="0" cellspacing="0" >
<tr><td><table width="100%" border="0" cellpadding="2" cellspacing="0" >
<tr>
  <td ><font style="font-size:15px; font-weight:bold;">Parcels Over 500g within Australia - B61/B66</font></td>
</tr>
<tr><td>
<table width="100%" cellpadding="2" cellspacing="0" border="0" class="inpbox" >
		<tr class="hdr"> 
		<td width="120px" nowrap rowspan="3">Destination</td>
		<td width="480px" align="center" nowrap colspan="6">Regular - B61/B66</td>
	 </tr>
	 <tr class="hdr"> 
		<td width="160px" nowrap  colspan="2" >
			Actual Weight Parcels
		</td>
		<td width="160px" nowrap colspan="2" >
			Cubic Weight Parcels
		</td>
		<td width="160px" nowrap colspan="2" >
			Total All Parcels
		</td>
	 </tr>
	 <tr class="hdr"> 
	 <td width="80px" nowrap>
	 	Quantity
	</td>
	<td width="80px" nowrap>
		Weight(kg)
	</td>
	<td width="80px" nowrap>
		Quantity
	</td>
	<td width="80px" nowrap>
		Weight(kg)
	</td>
	<td width="80px" nowrap>
		Quantity
	</td>
	<td width="80px" nowrap>
		Weight(kg)
	</td>
	</tr>
<!--##[?
	my $total_qty_m = $total_weight_m=0;
	for my $k (sort {$DESTINATION{$a}{displayorder} <=> $DESTINATION{$b}{displayorder}} keys %DESTINATION) {
		$OVWERM{$k}{quantity} = $OVWERM{$k}{quantity}? $OVWERM{$k}{quantity}:'&nbsp';
		$OVWERM{$k}{actual_weight} = $OVWERM{$k}{actual_weight}? $OVWERM{$k}{actual_weight}:'&nbsp;';
		$OVWERM{$k}{cubic_weight} = $OVWERM{$k}{cubic_weight}? $OVWERM{$k}{cubic_weight}:'&nbsp;';
		if($OVWERM{$k}{quantity} > 0 && $OVWERM{$k}{cubic_weight} eq '&nbsp;') {
			$OVWERM{$k}{cubic_weight} = 0;
		}
		print qq~##-->
		<tr class="row0">
			<td nowrap>$DESTINATION{$k}{name}</td>
			<td nowrap>$OVWERM{$k}{quantity}</td>
			<td nowrap>$OVWERM{$k}{actual_weight} </td>
			<td nowrap>$OVWERM{$k}{quantity} </td>
			<td nowrap>$OVWERM{$k}{cubic_weight}</td>
			<td nowrap>&nbsp;</td>
			<td nowrap>&nbsp;</td>
		</tr>
		<!--##~;
		$total_qty_m += $OVWERM{$k}{quantity};
		$total_weight_m +=  $OVWERM{$k}{actual_weight};
</tr>
	}
	print qq~##-->
		<tr class="row0">
	<td nowrap align= "right">Total</td>
	<td nowrap>&nbsp;</td>
			<td nowrap>&nbsp;</td>
			<td nowrap>&nbsp;</td>
			<td nowrap>&nbsp;</td>
			<td nowrap>$total_qty_m</td>
			<td nowrap>$total_weight_m</td>
		</tr>
				<!--##~;
?]##-->
</table>
</td>
	</tr></table></td>
</tr></table>
<br>
<table width="100%" border="0" cellpadding="0" cellspacing="0" >
<tr><td><table width="100%" border="0" cellpadding="2" cellspacing="0" >
<tr>
  <td ><font style="font-size:15px; font-weight:bold;">Parcels Within Australia Only</font></td>
</tr>
<tr><td>
<table width="50%" cellpadding="2" cellspacing="0" border="0" class="inpbox" >
	 <tr class="hdr"> 
		<td width="120px" nowrap ><b>Other Services</b></td>
		<td width="120px" nowrap >Domestic</td>
		<td width="120px" nowrap >External Territory</td>
	 </tr>
	 <tr class="row0"> 
		<td width="120px" nowrap >Receipted Delivery <b>B40</b></td>
		<td width="120px" nowrap ><!--##[? print $OSERVS{'domestic'}?$OSERVS{'domestic'}:'&nbsp;' ?]##--></td>
				<td width="120px" nowrap ><!--##[? print $OSERVS{'external'}?$OSERVS{'external'}:'&nbsp;' ?]##--></td>
	 </tr>
</table>
</td>
	</tr></table></td>
</tr></table>
<br>
<table width="100%" border="0" cellpadding="0" cellspacing="0" >
<tr><td><table width="100%" border="0" cellpadding="2" cellspacing="0" >
<tr>
  <td ><font style="font-size:15px; font-weight:bold;">Small Letters within Australia - B01</font></td>
</tr>
<tr><td>
<table width="50%" cellpadding="2" cellspacing="0" border="0" class="inpbox" >
	 <tr class="hdr"> 
		<td width="120px" nowrap ><b>Small Letters</b></td>
		<td width="120px" nowrap >Domestic</td>
		<td width="120px" nowrap >External Territory</td>
	 </tr>
	 <tr class="row0"> 
		<td width="120px" nowrap >Small Letters</td>
		<td width="120px" nowrap ><!--##[? print $SLETTERS{'domestic'}?$SLETTERS{'domestic'}:'&nbsp;' ?]##--></td>
				<td width="120px" nowrap ><!--##[? print $SLETTERS{'external'}?$SLETTERS{'external'}:'&nbsp;' ?]##--></td>
	 </tr>
</table>
</td>
	</tr></table></td>
</tr></table>
<br/>
<table width="100%" border="0" cellpadding="0" cellspacing="0" >
<tr><td><table width="100%" border="0" cellpadding="2" cellspacing="0" >
<tr>
  <td ><font style="font-size:15px; font-weight:bold;">
  	Large Letters within Australia - B03</font></td>
</tr>
<tr><td>
<table width="100%" cellpadding="2" cellspacing="0" border="0" class="inpbox" >
		<tr class="hdr"> 
		<td width="200px" nowrap><b>B03</b></td>
		<td width="150px" nowrap>Up to 125gms</td>
		<td width="150px" nowrap>Over 125g to 250g</td>
		<td width="150px" nowrap>Over 250g to 500g</td>
	 </tr>
		<tr class="row0">
			<td nowrap>Domestic</td>
			<td nowrap><!--##[? print $DLETTERS{'L'}{quantity}?$DLETTERS{'L'}{quantity}: '&nbsp;' ?]##--></td>
			<td nowrap><!--##[? print $DLETTERS{'M'}{quantity}?$DLETTERS{'M'}{quantity}: '&nbsp;'  ?]##--></td>
			<td nowrap><!--##[? print $DLETTERS{'H'}{quantity}?$DLETTERS{'H'}{quantity}: '&nbsp;'  ?]##--></td>
		</tr>
		<tr class="row0">
			<td nowrap>External Territories</td>
			<td nowrap><!--##[? print $ELETTERS{'L'}{quantity}?$ELETTERS{'L'}{quantity}:'&nbsp;' ?]##--></td>
			<td nowrap><!--##[? print $ELETTERS{'M'}{quantity}?$ELETTERS{'M'}{quantity}:'&nbsp;' ?]##--></td>
			<td nowrap><!--##[? print $ELETTERS{'H'}{quantity}?$ELETTERS{'H'}{quantity}:'&nbsp;' ?]##--></td>
		</tr>
</table>
</td>
	</tr></table></td>
</tr></table>
<br>
<table cellpadding="0" cellspacing="0" width="680px" border="0">
	<tr>
		<td>
	<b><font style="font-size:15px;">Customer Declaration</font></b><br>
I certify that these articles have been prepared in accordance with Australia Post terms and conditions for  lodgement and carriage and/or the special condtions of our contract with Australia 
Post and that details supplied are accurate. I acknowledge that these articles may be carried by air and declare that they do not contain any dangerous or prohibited goods.
(eg.explosives, flammables, corrosives, aerosois etc.).If in doubt ask at a Post office. A false declaration is a criminal offence.
	</td></tr>
	<tr>
	<td nowrap >
	<table width="100%" border="0" cellpadding="2" cellspacing="0" >
<tr class="hdr"> 
		<td width="120px" nowrap ><b>Customer's signature</b>______________________________</td>
		<td width="300px" align="center" nowrap ><b>Customer ID Recorded</b> ________________________________</td>
		<td width="120px" nowrap ><b>Received By</b> ________________________________</td>
	 </tr>
	</table>
  </td></tr>
</table>